version: "3"

services:
    web:
        build: web
        image: trip-meal-web
        env_file: .env
        environment:
            - DATABASE_URL=mysql://${MYSQL_USER}:${MYSQL_PASSWORD}@db:${MYSQL_PORT}/$tripmealdb
        networks:
            - backend
        ports:
            - ${SERVER_PORT}:${SERVER_PORT}
        depends_on:
            - db
    db: 
        build: db  
        image: trip-meal-db
        env_file: .env
        expose: 
            - 3306
        networks:
            - backend
        volumes:
            - ./db/db_data:/var/lib/mysql

volumes:
    trip-meal:

networks:
    backend:
